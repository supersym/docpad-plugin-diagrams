<h1>syntax-error</h1>
<pre><code class="lang-js"><span class="keyword">var</span> esprima = require(<span class="string">'esprima'</span>);

module.exports = <span class="function"><span class="keyword">function</span> <span class="params">(src, file)</span> {</span>
    <span class="keyword">if</span> (<span class="keyword">typeof</span> src !== <span class="string">'string'</span>) src = String(src);
    
    <span class="keyword">try</span> {
        Function(src);
        <span class="keyword">return</span>;
    }
    <span class="keyword">catch</span> (err) {
        <span class="keyword">if</span> (err.constructor.name !== <span class="string">'SyntaxError'</span>) <span class="keyword">throw</span> err;
        <span class="keyword">return</span> errorInfo(src, file);
    }
};

<span class="function"><span class="keyword">function</span> <span class="title">errorInfo</span> <span class="params">(src, file)</span> {</span>
    <span class="keyword">try</span> {
        esprima.parse(src);
        <span class="keyword">return</span>;
    }
    <span class="keyword">catch</span> (err) {
        <span class="keyword">return</span> <span class="keyword">new</span> ParseError(err, src, file);
    }
}

<span class="function"><span class="keyword">function</span> <span class="title">ParseError</span> <span class="params">(err, src, file)</span> {</span>
    SyntaxError.call(<span class="keyword">this</span>);
    
    <span class="keyword">this</span>.message = err.message.replace(<span class="regexp">/^Line \d+: /</span>, <span class="string">''</span>);
    
    <span class="keyword">this</span>.line = err.lineNumber;
    <span class="keyword">this</span>.column = err.column;
    
    <span class="keyword">this</span>.annotated = <span class="string">'\n'</span>
        + (file || <span class="string">'(anonymous file)'</span>)
        + <span class="string">':'</span> + <span class="keyword">this</span>.line
        + <span class="string">'\n'</span>
        + src.split(<span class="string">'\n'</span>)[<span class="keyword">this</span>.line - <span class="number">1</span>]
        + <span class="string">'\n'</span>
        + Array(<span class="keyword">this</span>.column).join(<span class="string">' '</span>) + <span class="string">'^'</span>
        + <span class="string">'\n'</span>
        + <span class="string">'ParseError: '</span> + <span class="keyword">this</span>.message
    ;
}

ParseError.prototype = <span class="keyword">new</span> SyntaxError;

ParseError.prototype.toString = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
    <span class="keyword">return</span> <span class="keyword">this</span>.annotated;
};

ParseError.prototype.inspect = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
    <span class="keyword">return</span> <span class="keyword">this</span>.annotated;
};
</code></pre>